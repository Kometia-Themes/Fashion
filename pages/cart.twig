{% extends 'layout.twig' %}

{% block body %}
<div class="container margin-top">
<div class="row">
  <div class="col-xs-12 section__title">
    <h1 class="section-heading section--italic">{{ settings.cart_title }}</h1>
    <br>
    <p>{{ settings.cart_description }}</p>
  </div>
</div>

{% if not cart or cart.items|length == 0 %}
<div class="row cart">
  <div class="col-sm-12">
    <p class="lead">No hay productos en el carrito.</p>
  </div>
</div>
{% else %}
<div class="row cart">
  <div class="col-sm-12">
    <table class="table table-responsive cart__resume-table">
      <thead>
        <tr>
          <th class="hidden-xs"></th>
          <th class="table__product-description">Producto</th>
          <th>Cantidad</th>
          <th class="text-right">Precio</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for item in cart.items %}
        <tr>
          <td class="hidden-xs" align="center">
            {% if item.sku.image_url is not empty %}
            <a href="/productos/{{ item.product.permalink }}{% if item.sku.permalink != 'default' %}/{{ item.sku.permalink }}{% endif %}"><img class="img-responsive" src="{{ item.sku.image_url }}&w=130" width="130" alt="{{ item.product.name }}"></a>
            {% elseif item.product.image_url is not empty %}
            <a href="/productos/{{ item.product.permalink }}{% if item.sku.permalink != 'default' %}/{{ item.sku.permalink }}{% endif %}"><img class="img-responsive" src="{{ item.product.image_url }}&w=130" width="130" alt="{{ item.product.name }}"></a>
            {% else %}
            <a href="/productos/{{ item.product.permalink }}{% if item.sku.permalink != 'default' %}/{{ item.sku.permalink }}{% endif %}"><img class="img-responsive" src="{{ 'placeholders/product-11.jpg' | global_img_url }}" width="130" alt="{{ item.product.name }}"></a>
            {% endif %}
          </td>
          <td>
            <a class="cart__resume-table__product-name" href="/productos/{{ item.product.permalink }}{% if item.sku.permalink != 'default' %}/{{ item.sku.permalink }}{% endif %}">
              {{ item.product.name }}{% if item.product.modifiers.count > 0 %} - {{ item.sku.name }}{% endif %}
            </a>
            <p>{{ item.product.excerpt | raw }}</p>
          </td>
          <td>
            <form action="/carrito/actualizar" method="post">
              <input type="hidden" name="_method" value="patch">
              <input type="hidden" name="id" value="{{ item.id }}">
              <select class="cart__resume-table__product-quantity" name="quantity">
                {% for qty in 1..5 %}
                <option value="{{ qty }}"{{ qty == item.quantity ? ' selected="selected"' : null }}>{{ qty }}</option>
                {% endfor %}
              </select>
              <button class="btn btn-link" type="submit"><i class="fa fa-refresh" aria-hidden="true"></i></span></button>
            </form>
          </td>
          <td class="cart__resume-table__product-amount">
            {{ item.total | money('symbol', 'code') }}
          </td>
          <td class="cart__resume-table__product-remove-column" width="5%">
            <form action="/carrito/eliminar" method="post" class="text-center">
              <input type="hidden" name="_method" value="delete">
              <input type="hidden" name="id" value="{{ item.id }}">
              <input type="hidden" name="quantity" value="0">
              <button type="submit" class="btn btn-link cart__resume-table__product-remove"><i class="fa fa-trash" aria-hidden="true"></i></button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<div class="cart-totals">
  <div class="row">
    <div class="col-sm-12 text-right">
      <h3 class="cart-total-row__title">TOTAL {{ cart.total_price | money('symbol', 'code') }}</h3>
      {% if store.is_tax_included %}
      <p>IVA Inclu√≠do</p>
      {% endif %}
    </div>
  </div>
</div>

<div class="row go-payment">
  <div class="col-sm-12">
    <div class="pull-left go-payment__buy-more">
      <a href="/productos" class="btn btn-lg text-uppercase">{{ settings.cart_btn_more_text }}</a>
    </div>
    <div class="pull-right go-payment__buy-now">
      <a href="/checkout" class="btn btn-lg text-uppercase">{{ settings.cart_btn_buy_text }}</a>
    </div>
  </div>
</div>
{% endif %}
</div>
{% endblock %}
